<mxfile host="app.diagrams.net" modified="2026-02-09T18:30:00.000Z" agent="Codex" version="24.7.5" type="device">
  <diagram id="app-aks-arch" name="App-AKS Architecture">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Tenant / Subscription -->
        <mxCell id="2" value="Azure AD Tenant" style="swimlane;rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="20" y="20" width="260" height="120" as="geometry"/>
        </mxCell>
        <mxCell id="3" value="Subscription (current)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#666666;" vertex="1" parent="2">
          <mxGeometry x="20" y="40" width="220" height="60" as="geometry"/>
        </mxCell>

        <!-- Resource Group -->
        <mxCell id="10" value="Resource Group: App-AKS" style="swimlane;rounded=1;whiteSpace=wrap;html=1;fillColor=#eef7ff;strokeColor=#3d5a80;" vertex="1" parent="1">
          <mxGeometry x="320" y="20" width="1240" height="920" as="geometry"/>
        </mxCell>

        <!-- VNet -->
        <mxCell id="20" value="VNet: app-aks" style="swimlane;rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f1f8;strokeColor=#3d5a80;" vertex="1" parent="10">
          <mxGeometry x="20" y="460" width="760" height="420" as="geometry"/>
        </mxCell>
        <mxCell id="21" value="Subnet: app_gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3d5a80;" vertex="1" parent="20">
          <mxGeometry x="20" y="50" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="22" value="Subnet: aks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3d5a80;" vertex="1" parent="20">
          <mxGeometry x="200" y="50" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="23" value="Subnet: appsvc_integration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3d5a80;" vertex="1" parent="20">
          <mxGeometry x="380" y="50" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="24" value="Subnet: private_endpoints" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3d5a80;" vertex="1" parent="20">
          <mxGeometry x="20" y="140" width="220" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="25" value="Subnet: apim" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3d5a80;" vertex="1" parent="20">
          <mxGeometry x="260" y="140" width="160" height="60" as="geometry"/>
        </mxCell>

        <!-- Core resources -->
        <mxCell id="30" value="Public IP (App GW)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="820" y="60" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="31" value="Application Gateway&#10;(WAF v2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1000" y="60" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="32" value="NAT Gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1220" y="60" width="140" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="33" value="AKS Private Cluster" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="820" y="140" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="34" value="App Service Plan&#10;(Windows)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1020" y="140" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="35" value="Web App Frontend&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1220" y="140" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="36" value="Web App Backend&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1420" y="140" width="180" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="37" value="Container Registry&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="820" y="220" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="38" value="Key Vault&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1020" y="220" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="39" value="Service Bus&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1200" y="220" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="40" value="Redis Cache&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1380" y="220" width="160" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="41" value="Storage Blob&#10;(private)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="820" y="300" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="42" value="Storage File (NFS)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1000" y="300" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="43" value="APIM Subnet NSG" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1200" y="300" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="44" value="API Management&#10;(optional)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#777777;dashed=1;" vertex="1" parent="10">
          <mxGeometry x="1380" y="300" width="160" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="45" value="PostgreSQL Flexible Server&#10;(optional)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#777777;dashed=1;" vertex="1" parent="10">
          <mxGeometry x="820" y="380" width="220" height="60" as="geometry"/>
        </mxCell>

        <!-- Observability -->
        <mxCell id="50" value="Log Analytics Workspace" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1080" y="380" width="200" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="51" value="Application Insights" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#2f3e46;" vertex="1" parent="10">
          <mxGeometry x="1300" y="380" width="180" height="60" as="geometry"/>
        </mxCell>

        <!-- Private DNS -->
        <mxCell id="60" value="Private DNS Zones&#10;privatelink.*" style="swimlane;rounded=1;whiteSpace=wrap;html=1;fillColor=#f7f7f7;strokeColor=#6c757d;" vertex="1" parent="1">
          <mxGeometry x="20" y="170" width="260" height="160" as="geometry"/>
        </mxCell>
        <mxCell id="61" value="AKS Private DNS Zone&#10;privatelink.&lt;region&gt;.azmk8s.io" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c757d;" vertex="1" parent="60">
          <mxGeometry x="20" y="60" width="220" height="80" as="geometry"/>
        </mxCell>

        <!-- Peering -->
        <mxCell id="70" value="GitHub Runners VNet (ghinfra)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c757d;" vertex="1" parent="1">
          <mxGeometry x="20" y="360" width="260" height="80" as="geometry"/>
        </mxCell>

        <!-- Managed identities -->
        <mxCell id="80" value="Managed Identity: AKS kubelet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c757d;dashed=1;" vertex="1" parent="10">
          <mxGeometry x="1080" y="460" width="220" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="81" value="Managed Identity: Web FE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c757d;dashed=1;" vertex="1" parent="10">
          <mxGeometry x="1320" y="460" width="180" height="60" as="geometry"/>
        </mxCell>
        <mxCell id="82" value="Managed Identity: Web BE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c757d;dashed=1;" vertex="1" parent="10">
          <mxGeometry x="1520" y="460" width="180" height="60" as="geometry"/>
        </mxCell>

        <!-- Connections -->
        <mxCell id="100" style="endArrow=block;html=1;" edge="1" parent="1" source="3" target="10">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="101" style="endArrow=block;html=1;" edge="1" parent="10" source="30" target="31">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="102" style="endArrow=block;html=1;" edge="1" parent="10" source="31" target="35">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="103" style="endArrow=block;html=1;" edge="1" parent="10" source="31" target="44">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="104" style="endArrow=block;html=1;" edge="1" parent="10" source="44" target="36">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="105" style="endArrow=block;html=1;" edge="1" parent="10" source="32" target="22">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="110" style="endArrow=block;html=1;" edge="1" parent="10" source="33" target="37">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="111" style="endArrow=block;html=1;" edge="1" parent="10" source="33" target="42">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="112" style="endArrow=block;html=1;" edge="1" parent="10" source="35" target="38">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="113" style="endArrow=block;html=1;" edge="1" parent="10" source="36" target="38">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="114" style="endArrow=block;html=1;" edge="1" parent="10" source="35" target="41">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="115" style="endArrow=block;html=1;" edge="1" parent="10" source="36" target="45">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Managed identity role assignments (dashed) -->
        <mxCell id="120" style="endArrow=block;html=1;dashed=1;" edge="1" parent="10" source="80" target="37">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="121" style="endArrow=block;html=1;dashed=1;" edge="1" parent="10" source="80" target="38">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="122" style="endArrow=block;html=1;dashed=1;" edge="1" parent="10" source="80" target="42">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="123" style="endArrow=block;html=1;dashed=1;" edge="1" parent="10" source="81" target="38">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="124" style="endArrow=block;html=1;dashed=1;" edge="1" parent="10" source="81" target="41">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="125" style="endArrow=block;html=1;dashed=1;" edge="1" parent="10" source="82" target="38">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Observability links -->
        <mxCell id="130" style="endArrow=block;html=1;" edge="1" parent="10" source="33" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="131" style="endArrow=block;html=1;" edge="1" parent="10" source="35" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="132" style="endArrow=block;html=1;" edge="1" parent="10" source="36" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="133" style="endArrow=block;html=1;" edge="1" parent="10" source="31" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="134" style="endArrow=block;html=1;" edge="1" parent="10" source="37" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="135" style="endArrow=block;html=1;" edge="1" parent="10" source="38" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="136" style="endArrow=block;html=1;" edge="1" parent="10" source="39" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="137" style="endArrow=block;html=1;" edge="1" parent="10" source="40" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="138" style="endArrow=block;html=1;" edge="1" parent="10" source="41" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="139" style="endArrow=block;html=1;" edge="1" parent="10" source="42" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="140" style="endArrow=block;html=1;" edge="1" parent="1" source="3" target="50">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="141" style="endArrow=block;html=1;" edge="1" parent="10" source="50" target="51">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- DNS + peering -->
        <mxCell id="150" style="endArrow=block;html=1;" edge="1" parent="1" source="20" target="60">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="151" style="endArrow=block;html=1;" edge="1" parent="1" source="20" target="61">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="152" style="endArrow=block;html=1;" edge="1" parent="1" source="70" target="60">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="153" style="endArrow=block;html=1;" edge="1" parent="1" source="70" target="61">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="154" style="endArrow=block;html=1;" edge="1" parent="1" source="20" target="70">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
